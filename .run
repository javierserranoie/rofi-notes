#!/bin/bash
set -ex

NOTES_FOLDER="/home/js/projects/rofi-notes"

selected=$(ls $NOTES_FOLDER | rofi -dmenu)
if [ ! -z "$selected" ]
then
	if [ -f "$NOTES_FOLDER/$selected" ]
	then
		xfce4-terminal -e "nvim $NOTES_FOLDER/$selected"
	else
		old_filename="$(date +%Y-%m-%d-%H-%M-%S)_$selected"
		touch "$NOTES_FOLDER/$old_filename"
		new_filename=$(detox -v -s lower "$NOTES_FOLDER/$old_filename"|grep ">"|awk 'BEGIN { FS = " -> " } ; { print $2 }')

		#xfce4-terminal -e "nvim $NOTES_FOLDER/$(date +%Y-%m-%d-%H-%M-%S)_$selected"
		xfce4-terminal -e "nvim $new_filename"
	fi
fi
#detox -s lower $NOTES_FOLDER
